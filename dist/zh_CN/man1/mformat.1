.\" -*- coding: UTF-8 -*-
'\" t
.\"*******************************************************************
.\"
.\" This file was generated with po4a. Translate the source file.
.\"
.\"*******************************************************************
.TH mformat 1 22Oct22 mtools\-4.0.42 
.SH Name
mformat \- 将 MSDOS 文件系统添加到底层格式化软盘
.de  TQ
.br
.ns
.TP \\$1
..

'\" t
.tr \(is'
.tr \(if`
.tr \(pd"

.SH Note\ of\ warning
此联机帮助页是从 mtools 的 texinfo 文档自动生成的，可能不完全准确或完整。 有关详细信息，请参见本手册页的末尾。
.PP
.SH Description
.PP
\&\f(CWmformat\fP 命令用于将 MS\-DOS 文件系统添加到底层格式的软盘中。它的语法是:
.PP
.nf
\fI\&\fP\&\f(CWmformat\fP [\&\f(CW\-t\fP \fIcylinders\fP|\&\f(CW\-T\fP \fItot_sectors\fP] [\&\f(CW\-h\fP \fIheads\fP] [\&\f(CW\-s\fP \fIsectors\fP]
  [\&\f(CW\-f\fP \fIsize\fP] [\&\f(CW\-1\fP] [\&\f(CW\-4\fP] [\&\f(CW\-8\fP]
  [\&\f(CW\-v\fP \fIvolume_label\fP]
  [\&\f(CW\-F\fP] [\&\f(CW\-S\fP \fIsizecode\fP]
  [\&\f(CW\-M\fP \fIsoftware_sector_size\fP]
  [\&\f(CW\-N\fP \fIserial_number\fP] [\&\f(CW\-a\fP]
  [\&\f(CW\-C\fP] [\&\f(CW\-H\fP \fIhidden_sectors\fP] [\&\f(CW\-I\fP \fIfsVersion\fP]
  [\&\f(CW\-r\fP \fIroot_sectors\fP] [\&\f(CW\-L\fP \fIfat_len\fP]
  [\&\f(CW\-B\fP \fIboot_sector\fP] [\&\f(CW\-k\fP]
  [\&\f(CW\-m\fP \fImedia_descriptor\fP]
  [\&\f(CW\-K\fP \fIbackup_boot\fP]
  [\&\f(CW\-R\fP \fInb_reserved_sectors\fP]
  [\&\f(CW\-c\fP \fIclusters_per_sector\fP]
  [\&\f(CW\-d\fP \fIfat_copies\fP]
  [\&\f(CW\-X\fP] [\&\f(CW\-2\fP \fIsectors_on_track_0\fP] [\&\f(CW\-3\fP]
  [\&\f(CW\-0\fP \fIrate_on_track_0\fP] [\&\f(CW\-A\fP \fIrate_on_other_tracks\fP]
  \fIdrive:\fP
.fi
 
.PP
\&\&\f(CWMformat\fP 将最小的 MS\-DOS 文件系统 (引导扇区、FAT 和根目录) 添加到已经用 Unix 底层格式格式化的软盘。
.PP
支持以下选项: (如果此 mtools 副本是在没有使用 USE_2M 选项的情况下编译的，则 S、2、1 和 M 选项可能不存在)
.PP
以下选项与 MS\-DOS 的格式命令相同:
.PP
.SH Options
.TP 
\&\&\f(CWv\fP\ 
指定卷标。卷标标识磁盘，最多可以包含 11 个字符。如果省略 \-v 开关，mformat 将不会为磁盘分配标签。
.TP 
\&\&\f(CWf\fP\ 
指定要格式化的 DOS 文件系统的大小。此标志仅支持一定数量的预定义尺寸; 对于其他人，请使用 \-h/\-t/\-s 标志。支持以下尺寸:
.RS
.TP 
160\ 
160K，单面，每磁道 8 个扇区，40 个柱面 (用于 5 1/4 DD)
.TP 
180\ 
160K，单面，每磁道 9 个扇区，40 个柱面 (用于 5 1/4 DD)
.TP 
320\ 
320K，双面，每磁道 8 个扇区，40 个柱面 (用于 5 1/4 DD)
.TP 
360\ 
360K，双面，每磁道 9 个扇区，40 个柱面 (用于 5 1/4 DD)
.TP 
720\ 
720K，双面，每磁道 9 个扇区，80 个柱面 (用于 3 1/2 DD)
.TP 
1200\ 
1200K，双面，每磁道 15 个扇区，80 个柱面 (用于 5 1/4 HD)
.TP 
1440\ 
1440K，双面，每磁道 18 个扇区，80 个柱面 (用于 3 1/2 HD)
.TP 
2880\ 
2880K，双面，每轨道 36 个扇区，80 个柱面 (用于 3 1/2 ED)
.RE
.TP 
\&\&\f(CWt\fP\ 
指定磁盘上的磁道数。
.TP 
\&\&\f(CWT\fP\ 
指定磁盘上的总扇区数。只能指定这 2 个选项中的一个 (轨道或总扇区)
.TP 
\&\&\f(CWh\fP\ 
头数 (sides)。
.TP 
\&\&\f(CWs\fP\ 
指定每个磁道的扇区数。如果给出了 2m 选项，泛型磁道上的 512 字节扇区等效数 (即不是磁头 0 磁道 0)。 如果未给出 2m
选项，则为每个磁道的物理扇区数 (可能大于 512 字节)。
.TP 
\&\&\f(CW1\fP\ 
格式化单面 (相当于 \-h 1)
.TP 
\&\&\f(CW4\fP\ 
格式化 360K 双面盘 (相当于 \-f 360)。与 \-the 1 开关配合使用，该开关格式化 180K 磁盘
.TP 
\&\&\f(CW8\fP\ 
格式化每磁道 8 个扇区的磁盘。
.PP
不支持 MS\-DOS 格式的 \&\f(CWq\fP、\&\f(CWu\fP 和 \&\f(CWb\fP 选项，\&\f(CWs\fP 有不同的含义。
.PP
以下选项特定于 mtools:
.IP
.TP 
\&\&\f(CWF\fP\ 
将分区格式化为 FAT32。
.TP 
\&\&\f(CWS\fP\ 
尺寸代码。扇区的大小是 2 ^ (sizecode + 7)。
.TP 
\&\&\f(CWX\fP\ 
将磁盘格式化为 XDF 磁盘。有关详细信息，请参见 XDF 部分。首先必须使用 fdutils 包中包含的 xdfcopy
实用程序对磁盘进行底层格式化。例如，XDF 磁盘用于 OS/2 安装磁盘。
.TP 
\&\&\f(CW2\fP\ 
2m 格式。此选项的参数描述磁道 0、磁头 0 上的扇区数。对于大于正常的扇区，建议使用此选项。
.TP 
\&\&\f(CW3\fP\ 
不要使用 2m 格式，即使磁盘的当前几何形状是 2m 几何形状。
.TP 
\&\&\f(CW0\fP\ 
轨道 0 上的数据传输速率
.TP 
\&\&\f(CWA\fP\ 
非 0 轨道上的数据传输速率
.TP 
\&\&\f(CWM\fP\ 
软件部门规模。此参数描述 MS\-DOS 文件系统使用的扇区大小 (以字节为单位)。默认情况下，它是物理扇区大小。
.TP 
\&\&\f(CWN\fP\ 
使用请求的序列号，而不是自动生成一个
.TP 
\&\&\f(CWa\fP\ 
如果给出此选项，则会生成一个 Atari 风格的序列号。 Ataris 将其序列号存储在 OEM 标签中。
.TP 
\&\&\f(CWC\fP\ 
创建磁盘映像文件以在其上安装 MS\-DOS 文件系统。显然，这对软盘和硬盘分区等物理设备没有用，但对图像文件很有趣。
.TP 
\&\&\f(CWH\fP\ 
隐藏扇区的数量。该参数用于格式化硬盘分区，硬盘分区不对齐磁道边界
(即第一个磁道的第一个磁头不属于该分区，但包含一个分区表)。在那种情况下，隐藏扇区的数量通常是每个柱面的扇区数量。这是未经测试的。
.TP 
\&\&\f(CWI\fP\ 
格式化 FAT32 驱动器时设置 fsVersion id。 为了查明这一点，请在现有的 FAT32 驱动器上运行
minfo，并将相关信息发邮件给我，这样我就可以在 future 版本的 mtools 中包含正确的值。
.TP 
\&\&\f(CWc\fP\ 
设置簇的大小 (以扇区为单位)。 如果此簇大小生成的 FAT 对于其位数而言太大，则 mtools 会自动增加簇大小，直到 FAT
足够小。如果没有明确指定簇大小，mtools 使用默认值，如下面 `每个簇的扇区数` 部分所述。
.TP 
\&\&\f(CWd\fP\ 
设置 FAT 副本的数量。默认值为 2。也可以使用 \&\f(CWMTOOLS_NFATS\fP 环境变量指定此设置。
.TP 
\&\&\f(CWr\fP\ 
设置根目录的大小 (以扇区为单位)。 仅适用于 12 位和 16 位 FAT。也可以使用 \&\&\f(CWMTOOLS_DIR_LEN\fP
环境变量指定此设置。
.TP 
\&\&\f(CWL\fP\ 
设置 FAT 的长度。
.TP 
\&\&\f(CWB\fP\ 
使用存储在给定文件或设备中的引导扇区，而不是使用它自己的。 仅更新几何字段以匹配目标磁盘参数。
.TP 
\&\&\f(CWk\fP\ 
尽可能保留现有的引导扇区。 只有几何字段和其他类似的文件系统数据被更新以匹配目标磁盘参数。
.TP 
\&\&\f(CWK\fP\ 
设置应存储引导扇区备份的扇区号 (仅与 FAT32 相关)。
.TP 
\&\&\f(CWR\fP\ 
设置此文件系统的保留扇区数。对于非 FAT32 磁盘必须至少为 1，对于 FAT 磁盘必须至少为 3 (以容纳引导扇区、信息扇区和备份引导扇区)。
.TP 
\&\&\f(CWm\fP\ 
为此磁盘使用非标准媒体描述符字节。媒体描述符存储在引导扇区的第 21 位，并且作为每个 FAT 副本中的第一个字节。使用此选项可能会混淆 DOS
或较旧的 mtools 版本，并可能使磁盘无法读取。仅当您知道自己在做什么时才使用。
.PP
要以默认以外的密度格式化软盘，您必须 (至少) 提供与默认不同的那些命令行参数。
.PP
\&\&\f(CWMformat\fP 成功返回 0，失败返回 1。
.PP
它不会将坏块信息记录到 Fat，为此使用 \&\&\f(CWmbadblocks\fP。
.PP
.SH Number\ of\ sectors\ per\ cluster
.PP
如果用户没有指定簇大小，mformat 会计算出一个默认值。
.PP
对于 FAT32，它使用下表来确定每个簇的扇区数，具体取决于文件系统上的扇区总数。
.PP
大于 32*1024*1024*2: 64 扇区
.br
在 16*1024*1024*2 和 32*1024*1024*2 之间: 32 个扇区
.br
8*1024*1024*2 和 16*1024*1024*2 之间: 16 个扇区
.br
在 260*1024*2 和 81024*1024*2 之间: 1 个扇区
.br
.PP
这个来源于微软的 \&\&\f(CWfatgen103\fP 文档第 20 页的信息，目前可以在以下地址找到:
.PP
\&\&\f(CWhttps://staff.washington.edu/dittrich/misc/fatgen103.pdf\fP
.PP
对于 FAT12 和 FAT16，mformat 使用迭代方法，它从一个设定值开始，它会加倍，直到它能够使用该簇大小和小于允许的最大值的簇数填满磁盘。
.PP
1 个磁头或少于 2000 个扇区的磁盘的起始值为 1，1 个磁头以上且超过 2000 个扇区的磁盘的起始值为 2。
.PP
每个簇的扇区数不能超过 128。
.PP
.SH See\ Also
Mtools 的 texinfo 文档
.SH Viewing\ the\ texi\ doc
此联机帮助页是从 mtools 的 texinfo 文档自动生成的。然而，这个过程只是近似的，一些项目，如交叉引用、脚注和索引在这个翻译过程中丢失了。
实际上，这些项在联机帮助页格式中没有适当的表示。 此外，并非所有信息都已翻译成联机帮助页版本。 因此，我强烈建议您使用原始的 texinfo 文档。
有关如何查看 texinfo 文档的说明，请参见本联机帮助页的末尾。
.TP 
* \ \ 
要从 texinfo 文档生成可打印副本，请运行以下命令:
 
.nf
.in +0.3i
\fB    ./configure; make dvi; dvips mtools.dvi\fP
.fi
.in -0.3i
.PP
 
\&\fR
.TP 
* \ \ 
要生成 html 副本，请运行:
 
.nf
.in +0.3i
\fB    ./configure; make html\fP
.fi
.in -0.3i
.PP
 
\&A premade html 可以在
\&\&\f(CW\(ifhttp://www.gnu.org/software/mtools/manual/mtools.html\(is\fP 找到
.TP 
* \ \ 
要生成信息副本 (可使用 emacs 的信息模式浏览)，请运行:
 
.nf
.in +0.3i
\fB    ./configure; make info\fP
.fi
.in -0.3i
.PP
 
\&\fR
.PP
texinfo 文档在打印或作为 html 时看起来最漂亮。 实际上，由于 info 中使用的引用约定，某些示例在 info 版本中很难阅读。
.PP
.PP
.SH [手册页中文版]
.PP
本翻译为免费文档；阅读
.UR https://www.gnu.org/licenses/gpl-3.0.html
GNU 通用公共许可证第 3 版
.UE
或稍后的版权条款。因使用该翻译而造成的任何问题和损失完全由您承担。
.PP
该中文翻译由 wtklbm
.B <wtklbm@gmail.com>
根据个人学习需要制作。
.PP
项目地址:
.UR \fBhttps://github.com/wtklbm/manpages-chinese\fR
.ME 。
