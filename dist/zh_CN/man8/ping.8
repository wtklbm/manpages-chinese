.\" -*- coding: UTF-8 -*-
'\" t
.\"*******************************************************************
.\"
.\" This file was generated with po4a. Translate the source file.
.\"
.\"*******************************************************************
.TH PING 8 "" "iputils 20221126" iputils
.ie  \n(.g .ds Aq \(aq
.el       .ds Aq '
.\" -----------------------------------------------------------------
.\" * Define some portability stuff
.\" -----------------------------------------------------------------
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.\" http://bugs.debian.org/507673
.\" http://lists.gnu.org/archive/html/groff/2009-02/msg00013.html
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.\" -----------------------------------------------------------------
.\" * set default formatting
.\" -----------------------------------------------------------------
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.\" -----------------------------------------------------------------
.\" * MAIN CONTENT STARTS HERE *
.\" -----------------------------------------------------------------
.SH NAME
ping \- 向网络主机发送 ICMP ECHO_REQUEST
.SH SYNOPSIS
.HP \w'\fBping\fR\ 'u
\fBping\fP [\fB\-aAbBdCDefhLnOqrRUvV46\fP] [\fB\-c\ \fP\fIcount\fP] [\fB\-F\ \fP\fIflowlabel\fP]
[\fB\-i\ \fP\fIinterval\fP] [\fB\-I\ \fP\fIinterface\fP] [\fB\-l\ \fP\fIpreload\fP] [\fB\-m\ \fP\fImark\fP] [\fB\-M\ \fP\fIpmtudisc_option\fP] [\fB\-N\ \fP\fInodeinfo_option\fP] [\fB\-w\ \fP\fIdeadline\fP] [\fB\-W\ \fP\fItimeout\fP] [\fB\-p\ \fP\fIpattern\fP] [\fB\-Q\ \fP\fItos\fP] [\fB\-s\ \fP\fIpacketsize\fP] [\fB\-S\ \fP\fIsndbuf\fP] [\fB\-t\ \fP\fIttl\fP] [\fB\-T\ \fP\fItimestamp\ option\fP] [hop\&.\&.\&.] {destination}
.SH DESCRIPTION
.PP
\fBping\fP 使用 ICMP 协议 \*(Aqs 强制 ECHO_REQUEST 数据报从主机或网关引出 ICMP
ECHO_RESPONSE\&。ECHO_REQUEST 数据报 (\(lqpings\(rq) 有一个 IP 和 ICMP
报头，后跟一个结构体时间间隔，然后是任意数量的 \(lqpad\(rq 字节用于填充数据包 \&。
.PP
\fBping\fP 适用于 IPv4 和 IPv6\&。可以通过指定 \fB\-4\fP 或 \fB\-6\fP\& 强制仅显式使用其中之一。
.PP
\fBping\fP 还可以发送 IPv6 节点信息查询 (RFC4620)\&。可能不允许使用中间 \fIhop\fPs，因为不推荐使用 IPv6 源路由
(RFC5095)\&。
.SH OPTIONS
.PP
\fB\-4\fP
.RS 4
仅使用 IPv4\&。
.RE
.PP
\fB\-6\fP
.RS 4
仅使用 IPv6\&。
.RE
.PP
\fB\-a\fP
.RS 4
可听见的 ping\&。
.RE
.PP
\fB\-A\fP
.RS 4
自适应 ping\&。数据包间间隔适应往返时间，因此网络中实际上不超过一个 (或多个，如果设置了预加载) 未应答的探测 \&。除非超级用户
\&，否则最小间隔为 200 毫秒。在 RTT 较低的网络上，此模式本质上等同于泛洪模式 \&。
.RE
.PP
\fB\-b\fP
.RS 4
允许 ping 一个广播地址 \&。
.RE
.PP
\fB\-B\fP
.RS 4
不允许 \fBping\fP 更改探测器的源地址 \&。地址绑定到 \fBping\fP 启动时选择的一个 \&。
.RE
.PP
\fB\-c\fP \fIcount\fP
.RS 4
发送 \fIcount\fP ECHO_REQUEST 数据包后停止 \&。使用 \fIdeadline\fP 选项，\fBping\fP 等待 \fIcount\fP
ECHO_REPLY 数据包，直到超时到期 \&。
.RE
.PP
\fB\-C\fP
.RS 4
调用 connect() syscall on socket creation\&。
.RE
.PP
\fB\-d\fP
.RS 4
在正在使用的套接字上设置 SO_DEBUG 选项 \&。本质上，Linux 内核不使用此套接字选项 \&。
.RE
.PP
\fB\-e\fP
.RS 4
设置 ECHO_REQUEST\& 的标识字段。值 0 表示使用 \fIraw socket\fP (\fIICMP datagram socket\fP)\&
不支持。该字段的值可以使用 \fB\-v\fP 选项 \& 打印。
.RE
.PP
\fB\-D\fP
.RS 4
在每行之前打印时间戳 (unix 时间 + 微秒，如 gettimeofday)。
.RE
.PP
\fB\-f\fP
.RS 4
洪水 ping\&。对于每个发送的 ECHO_REQUEST，都会打印一个句点 \(lq\&.\(rq，而对于收到的每个
ECHO_REPLY，都会打印一个退格符 \&。这提供了一个快速显示有多少数据包被抛弃
\&。如果未给出间隔，它将间隔设置为零，并以数据包返回的速度或每秒一百次的速度输出数据包，以较大者为准 \&。只有超级用户可以使用此选项，间隔为零
\&。
.RE
.PP
\fB\-F\fP \fIflow label\fP
.RS 4
仅限 IPv6\&. 在回显请求数据包上分配并设置 20 位流标签 (十六进制) \&。如果值为零，内核分配随机流标签 \&。
.RE
.PP
\fB\-h\fP
.RS 4
显示帮助 \&。
.RE
.PP
\fB\-i\fP \fIinterval\fP
.RS 4
在发送每个数据包之间等待 \fIinterval\fP 秒 \&。允许使用点作为小数点分隔符的实数 (无论区域设置如何)
\&。默认是在每个数据包之间正常等待一秒，或者在泛洪模式下不等待 \&。只有超级用户可以将间隔设置为小于 2 ms\& 的值。
.RE
.PP
\fB\-I\fP \fIinterface\fP
.RS 4
\fIinterface\fP 是地址、接口名称或 VRF 名称 \&。如果 \fIinterface\fP 是一个地址，它将源地址设置为指定的接口地址 \&。如果
\fIinterface\fP 是接口名称，它将源接口设置为指定的接口 \&。如果 \fIinterface\fP 是一个 VRF
名称，则每个数据包都使用相应的路由表进行路由; 在这种情况下，可以重复 \fB\-I\fP 选项来指定源地址 \&。注意: 对于 IPv6，当对本地链接地址执行
ping 操作时，可以使用链接规范 (通过 \*(Aq%\* (\fIdestination\fP 中的 Aq 符号，或通过此选项)，但不再需要 \&。
.RE
.PP
\fB\-l\fP \fIpreload\fP
.RS 4
如果指定了 \fIpreload\fP，则 \fBping\fP 发送那么多不等待回复的数据包 \&。只有超级用户可以选择超过 3\& 的预加载。
.RE
.PP
\fB\-L\fP
.RS 4
抑制组播数据包的回环 \&。此标志仅在 ping 目标是多播地址 \& 时适用。
.RE
.PP
\fB\-m\fP \fImark\fP
.RS 4
使用 \fImark\fP 来标记出去的数据包 \&。由于内核中的各种原因，这很有用，例如使用策略路由来选择特定的出站处理 \&。
.RE
.PP
\fB\-M\fP \fIpmtudisc_opt\fP
.RS 4
选择路径 MTU 发现策略 \&。 \fIpmtudisc_option\fP 可以是 \fIdo\fP (禁止分片，即使是本地的)，\fIwant\fP (做 PMTU
发现，当数据包很大时在本地分片)，或者 \fIdont\fP (不设置 DF 标志) \&。
.RE
.PP
\fB\-N\fP \fInodeinfo_option\fP
.RS 4
仅限 IPv6\&. 发送 ICMPv6 节点信息查询 (RFC4620)，而不是 Echo Request\&。需要 CAP_NET_RAW 功能
\&。
.PP
\fBhelp\fP
.RS 4
显示 NI 支持的帮助 \&。
.RE
.PP
\fBname\fP
.RS 4
查询节点名称 \&。
.RE
.PP
\fBipv6\fP
.RS 4
查询 IPv6 地址 \&。有几个 IPv6 特定的标志 \&。
.PP
\fBipv6\-global\fP
.RS 4
请求 IPv6 全局 \- 使用域地址 \&。
.RE
.PP
\fBipv6\-sitelocal\fP
.RS 4
请求 IPv6 站点本地地址 \&。
.RE
.PP
\fBipv6\-linklocal\fP
.RS 4
请求 IPv6 链接本地地址 \&。
.RE
.PP
\fBipv6\-all\fP
.RS 4
在其他接口上请求 IPv6 地址 \&。
.RE
.RE
.PP
\fBipv4\fP
.RS 4
查询 IPv4 地址 \&。有一个 IPv4 特定标志 \&。
.PP
\fBipv4\-all\fP
.RS 4
在其他接口上请求 IPv4 地址 \&。
.RE
.RE
.PP
\fBsubject\-ipv6=\fP\fIipv6addr\fP
.RS 4
IPv6 主题地址 \&.
.RE
.PP
\fBsubject\-ipv4=\fP\fIipv4addr\fP
.RS 4
IPv4 主题地址 \&.
.RE
.PP
\fBsubject\-name=\fP\fInodename\fP
.RS 4
主题名称 \&。如果它包含一个以上的点，则假定为完全限定的域名 \&。
.RE
.PP
\fBsubject\-fqdn=\fP\fInodename\fP
.RS 4
主题名称 \&。始终采用完全限定的域名 \&。
.RE
.RE
.PP
\fB\-n\fP
.RS 4
仅输出数字 \&。不会尝试查找主机地址的符号名称 \&。
.RE
.PP
\fB\-O\fP
.RS 4
在发送下一个数据包之前报告未完成的 ICMP ECHO 回复。这与时间戳 \fB\-D\fP 一起很有用，可以将输出记录到诊断文件并搜索丢失的答案 \&。
.RE
.PP
\fB\-p\fP \fIpattern\fP
.RS 4
您最多可以指定 16\(lqpad\(rq 字节来填写您发送的数据包 \&。这对于诊断网络中的数据相关问题很有用。比如 \fB\-p ff\fP
会导致发送的数据包全 1\&。
.RE
.PP
\fB\-q\fP
.RS 4
安静的输出 \&。除了启动时和完成时的总结行 \& 外，不显示任何内容。
.RE
.PP
\fB\-Q\fP \fItos\fP
.RS 4
在 ICMP 数据报中设置服务质量 \-related 位 \&。 \fItos\fP 只能是十进制 (\fBping\fP) 或十六进制数 \&。
.sp
在 RFC2474 中，这些字段被解释为 8 位差分服务 (DS)，包括: 独立数据的位 0\-1 (最低 2 位) 和差分服务代码点 (DSCP)\&
的位 2\-7 (最高 6 位)。在 RFC2481 和 RFC3168 中，位 0\-1 用于 ECN\&。
.sp
历史上 (RFC1349，被 RFC2474 废弃)，这些被解释为: 保留位 0 (最低位) (当前被重新定义为拥塞控制)，服务类型 1\-4 和优先级
5\-7 (最高位) \&。
.RE
.PP
\fB\-r\fP
.RS 4
绕过正常的路由表并直接发送到连接接口上的主机 \&。如果主机不在直接连接的网络上，则返回错误 \&。此选项可用于通过没有路由的接口 ping
本地主机，前提是还使用了选项 \fB\-I\fP\&。
.RE
.PP
\fB\-R\fP
.RS 4
仅限 \fBping\fP\&. 记录路线 \&。在 ECHO_REQUEST 数据包中包含 RECORD_ROUTE 选项，并在返回的数据包上显示路由缓冲区
\&。请注意，IP 标头仅够用于九个这样的路由 \&。许多主机忽略或丢弃此选项 \&。
.RE
.PP
\fB\-s\fP \fIpacketsize\fP
.RS 4
指定要发送的数据字节数 \&。默认值为 56，当与 8 字节的 ICMP 标头数据 \& 组合时，它转换为 64 个 ICMP 数据字节。
.RE
.PP
\fB\-S\fP \fIsndbuf\fP
.RS 4
设置套接字 sndbuf\&。如果不指定，则选择缓存不超过一个数据包。
.RE
.PP
\fB\-t\fP \fIttl\fP
.RS 4
仅限 \fBping\fP\&. 将 IP 时间设置为 Live\&。
.RE
.PP
\fB\-T\fP \fItimestamp option\fP
.RS 4
设置特殊的 IP 时间戳选项 \&。 \fItimestamp option\fP 可以是 \fItsonly\fP (仅时间戳)、\fItsandaddr\fP
(时间戳和地址) 或 \fItsprespec host1 [host2 [host3 [host4]]]\fP (时间戳预先指定的跃点) \&。
.RE
.PP
\fB\-U\fP
.RS 4
打印完整的用户到用户延迟 (旧行为) \&。通常 \fBping\fP 打印网络往返时间，可以不同 f\&.e\&。由于 DNS 故障 \&。
.RE
.PP
\fB\-v\fP
.RS 4
详细输出 \&。ping 多播地址 \& 时不要抑制 DUP 回复。
.RE
.PP
\fB\-V\fP
.RS 4
显示版本并退出 \&。
.RE
.PP
\fB\-w\fP \fIdeadline\fP
.RS 4
在 \fBping\fP 退出之前指定超时 (以秒为单位)，无论已发送或接收了多少数据包 \&。在这种情况下，\fBping\fP 在发送 \fIcount\fP
数据包后不会停止，它会等待 \fIdeadline\fP 过期或直到 \fIcount\fP 探测得到应答，或者等待来自网络的某些错误通知 \&。
.RE
.PP
\fB\-W\fP \fItimeout\fP
.RS 4
等待响应的时间，以秒为单位 \&。该选项仅在没有任何响应时影响超时，否则 \fBping\fP 等待两个 RTT\&。允许使用点作为小数点分隔符的实数
(无论区域设置如何) \&。0 表示无限超时 \&。
.RE
.PP
使用 \fBping\fP 做故障隔离时，首先要在本地主机上运行，验证本地网络接口是否正常运行 \&。那么，越来越远的主机和网关应该是
\(lqpinged\(rq\&. 计算往返时间和丢包统计数据。如果收到重复的数据包，则它们不包括在数据包丢失计算中，尽管这些数据包的往返时间用于计算
minimum/average/maximum/mdev 往返时间数 \&。
.PP
总体标准偏差 (mdev)，本质上是每个 ping RTT 与平均 RTT\& 的差距的平均值。mdev 越高，RTT 的可变性越大 (随着时间的推移)
\&。由于 RTT 可变性高，您将遇到批量传输的速度问题 (它们将花费比严格来说必要的时间更长的时间，因为可变性最终会导致发送者等待 ACK)
并且您将拥有中等至差的 VoIP 质量 \&。
.PP
当已发送 (和接收) 指定数量的数据包时，或者如果程序以 SIGINT 终止，将显示一个简短的总结 \&。可以在不使用信号 SIGQUIT\&
终止进程的情况下获得较短的当前统计信息。
.PP
如果 \fBping\fP 根本没有收到任何回复数据包，它将以代码 1\& 退出。如果同时指定了数据包 \fIcount\fP 和 \fIdeadline\fP，并且在
\fIdeadline\fP 到达时收到的数据包少于 \fIcount\fP，它也将以代码 1\& 退出。在其他错误中，它以代码 2\& 退出。否则它以代码 0\&
退出。这使得可以使用退出代码来查看主机是否处于活动状态 \&。
.PP
本程序适用于网络测试、测量和管理。由于它会给网络带来负载，因此在正常操作期间或从自动化脚本中使用 \fBping\fP 是不明智的 \&。
.SH "IPV6 LINK\-LOCAL DESTINATIONS"
.PP
对于 IPv6，当目的地址有 link\-local 作用域且 \fBping\fP 正在使用 \fIICMP datagram sockets\fP
时，必须指定输出接口 \&。当 \fBping\fP 使用 \fIraw sockets\fP 时，并不一定要指定输出接口，但在有多个可能的输出接口 \&
时避免歧义。
.PP
指定输出接口有两种方式:
.PP
\(bu 使用 \fI% notation\fP
.RS 4
目标地址以 \fI%\fP 和输出接口名称或 ifindex 为后缀，例如:
.sp
\fBping fe80::5054:ff:fe70:67bc%eth0\fP
.sp
\fBping fe80::5054:ff:fe70:67bc%2\fP
.RE
.PP
\(bu 使用 \fI\-I option\fP
.RS 4
使用 \fIICMP datagram sockets\fP 时，自以下内核版本开始支持此方法:
5\&.17、5\&.15\&.19、5\&.10\&.96、5\&.4\&.176、4\&.19\&.228、4\&.14\&.265\&。musl
libc\& 也不支持它。
.RE
.SH "ICMP PACKET DETAILS"
.PP
一个没有选项的 IP 头是 20 字节 \&。ICMP ECHO_REQUEST 数据包包含额外的 8 字节值的 ICMP 标头，后跟任意数量的数据
\&。当给定一个 \fIpacketsize\fP 时，表示这块额外数据的大小 (默认为 56) \&。因此，在 ICMP ECHO_REPLY 类型的 IP
数据包中接收到的数据量将始终比请求的数据空间 (ICMP 标头) \& 多 8 个字节。
.PP
如果数据空间的大小至少为结构体 timeval \fBping\fP 使用该空间的开始字节来包含它在计算往返时间 \&
时使用的时间戳。如果数据空间较短，则不给出往返时间 \&。
.SH "DUPLICATE AND DAMAGED PACKETS"
.PP
\fBping\fP 将报告重复和损坏的数据包 \&。重复的数据包应该永远不会发生，并且似乎是由不适当的链路级重传引起的
\&。重复可能在许多情况下发生并且很少 (如果有的话) 是一个好兆头，尽管低水平重复的存在可能并不总是引起警报 \&。
.PP
损坏的数据包显然是引起警报的严重原因，并且通常表示 \fBping\fP 数据包 \* (Aqs 路径 (在网络或主机中) \& 中某处的硬件损坏。
.SH "TRYING DIFFERENT DATA PATTERNS"
.PP
(内部) 网络层永远不应根据数据部分中包含的数据区别对待数据包。不幸的是，众所周知，数据相关问题会潜入网络并且长时间未被发现
\&。在许多情况下，会出现问题的特定模式是不 \*(Aqt 有足够的 \(lqtransitions\(rq，例如全 1 或全 0，或者恰好位于
edge 的模式，例如几乎全 0\&. \*(Aqt 必须足以在命令行上指定全零的数据模式
(例如)，因为感兴趣的模式处于数据链路级别，以及您键入的内容与控制器传输的内容之间的关系可以很复杂 \&。
.PP
这意味着如果您有一个数据相关的问题，您可能需要做很多测试才能找到它 \&。如果幸运的话，您可能会设法找到一个文件，该文件要么可以 \*(Aqt
通过您的网络发送，要么比其他类似长度的文件需要更长的传输时间 \&。然后您可以检查此文件中的重复模式，您可以使用 \fBping\fP\& 的 \fB\-p\fP
选项测试这些模式。
.SH "TTL DETAILS"
.PP
IP 数据包的 TTL 值表示数据包在被丢弃之前最多可以经过的 IP 路由器数 \&。在目前的实践中，您可以期望 Internet 中的每个路由器都将
TTL 字段递减一个 \&。
.PP
TCP/IP 规范规定 TCP 数据包的 TTL 字段应设置为 60，但许多系统使用较小的值 (4\&.3 BSD 使用 30，4\&.2 使用 15)
\&。
.PP
该字段的最大可能值为 255，大多数 Unix 系统将 ICMP ECHO_REQUEST 数据包的 TTL 字段设置为
255\&。这就是为什么您会发现您可以 \(lqping\(rq 一些主机，但不能用 \fBtelnet\fP(1) 或 \fBftp\fP(1)\& 到达它们。
.PP
在正常操作中，ping 从它接收的数据包中打印 TTL 值 \&。当远程系统收到 ping 数据包时，它可以在响应中使用 TTL
字段执行以下三种操作之一:
.PP
.RS 4
\(bu 不改变它; 这是 Berkeley Unix 系统在 4\&.3BSD Tahoe 发布之前所做的。在这种情况下，接收到的数据包中的 TTL
值将是 255 减去往返路径中的路由器数量 \&。
.RE
.PP
.RS 4
\(bu 设置为 255; 这就是当前 Berkeley Unix 系统所做的 \&。在这种情况下，接收到的数据包中的 TTL 值将是 255 减去路径
\fBfrom\fP 远程系统 \fBto\fP \fBping\fPing 主机 \& 中的路由器数。
.RE
.PP
.RS 4
\(bu 将其设置为其他值 \&。有些机器对 ICMP 数据包使用与它们对 TCP 数据包相同的值，例如 30 或
60\&。其他人可能会使用完全狂野的值观 \&。
.RE
.SH BUGS
.PP
.RS 4
\(bu 许多主机和网关忽略 RECORD_ROUTE 选项 \&。
.RE
.PP
.RS 4
\(bu 最大 IP 标头长度对于 RECORD_ROUTE 之类的选项来说太小，无法完全发挥作用 \&。那里 \*(Aqs 对此无能为力，但是 \&。
.RE
.PP
.RS 4
\(bu Flood ping 一般不推荐，Flood ping 广播地址只能在非常受控的条件下进行 \&。
.RE
.SH "SEE ALSO"
.PP
\fBip\fP(8), \fBss\fP(8)\&.
.SH HISTORY
.PP
\fBping\fP 命令出现在 4\&.3BSD\& 中。
.PP
此处描述的版本是其特定于 Linux\& 的后代。
.PP
从版本 s20150815 开始，\fBping6\fP 二进制文件不再 \*(Aqt 存在 \&。它已合并到 \fBping\fP\&。创建指向 \fBping\fP
的名为 \fBping6\fP 的符号链接将产生与之前相同的功能 \&。
.SH SECURITY
.PP
\fBping\fP 需要执行 CAP_NET_RAW 功能 1) 如果程序用于非回显查询 (请参见 \fB\-N\fP 选项) 或当 ECHO_REQUEST
的标识字段设置为 0 (请参见 \fB\-e\fP)，或 2) 如果内核不支持 ICMP 数据报套接字，或 3) 如果不允许用户创建 ICMP 回显套接字
\&。该程序可以用作 set\-uid root\&。
.SH AVAILABILITY
.PP
\fBping\fP 是 \fIiputils\fP 包的一部分 \&。
.PP
.SH [手册页中文版]
.PP
本翻译为免费文档；阅读
.UR https://www.gnu.org/licenses/gpl-3.0.html
GNU 通用公共许可证第 3 版
.UE
或稍后的版权条款。因使用该翻译而造成的任何问题和损失完全由您承担。
.PP
该中文翻译由 wtklbm
.B <wtklbm@gmail.com>
根据个人学习需要制作。
.PP
项目地址:
.UR \fBhttps://github.com/wtklbm/manpages-chinese\fR
.ME 。
